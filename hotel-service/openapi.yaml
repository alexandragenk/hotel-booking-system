openapi: 3.0.3
info:
  title: Hotel Service API
  version: 1.0.0
  description: 'API for managing hotels and rooms, including room availability confirmation/release.


    Authentication: JWT Bearer.

    Roles:

    - ADMIN: create hotels and rooms

    - USER: read hotels/rooms, get recommendations, confirm/release availability

    '
servers:
  - url: http://localhost:8081
tags:
  - name: Hotels
  - name: Rooms
security:
  - bearerAuth: []
paths:
  /api/hotels:
    post:
      tags:
        - Hotels
      summary: Create a hotel (admin)
      operationId: createHotel
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Hotel'
      responses:
        '200':
          description: Created hotel
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Hotel'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
    get:
      tags:
        - Hotels
      summary: List hotels
      operationId: listHotels
      responses:
        '200':
          description: Hotels
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Hotel'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
  /api/rooms:
    post:
      tags:
        - Rooms
      summary: Create a room (admin)
      operationId: createRoom
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Room'
      responses:
        '200':
          description: Created room
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Room'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
    get:
      tags:
        - Rooms
      summary: List rooms
      operationId: listRooms
      parameters:
        - name: hotelId
          in: query
          required: false
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Rooms
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/RoomDto'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
  /api/rooms/recommend:
    get:
      tags:
        - Rooms
      summary: Recommend rooms
      operationId: recommendRooms
      parameters:
        - name: hotelId
          in: query
          required: false
          schema:
            type: integer
            format: int64
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            format: int32
            default: 10
      responses:
        '200':
          description: Recommended rooms
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/RoomDto'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
  /api/rooms/{id}/confirm-availability:
    post:
      tags:
        - Rooms
      summary: Confirm room availability for a period (hold/confirm)
      operationId: confirmRoomAvailability
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: startDate
          in: query
          required: true
          schema:
            type: string
            format: date
        - name: endDate
          in: query
          required: true
          schema:
            type: string
            format: date
      responses:
        '200':
          description: Availability confirmation result
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RoomAvailabilityResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
  /api/rooms/{id}/release:
    post:
      tags:
        - Rooms
      summary: Release a room for a period
      operationId: releaseRoom
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: startDate
          in: query
          required: true
          schema:
            type: string
            format: date
        - name: endDate
          in: query
          required: true
          schema:
            type: string
            format: date
      responses:
        '204':
          description: Released
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    Hotel:
      type: object
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string
        address:
          type: string
    Room:
      type: object
      properties:
        id:
          type: integer
          format: int64
        hotelId:
          type: string
          example: '0'
        number:
          type: string
          example: '101'
        timesBooked:
          type: integer
          format: int64
    RoomDto:
      type: object
      properties:
        id:
          type: integer
          format: int64
        hotelId:
          type: integer
          format: int64
        number:
          type: string
        timesBooked:
          type: integer
          format: int64
    RoomAvailabilityResponse:
      type: object
      required:
        - confirmed
      properties:
        confirmed:
          type: boolean
    ErrorResponse:
      type: object
      required:
        - message
      properties:
        message:
          type: string
  responses:
    BadRequest:
      description: Bad request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    Unauthorized:
      description: Unauthorized
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    Forbidden:
      description: Forbidden
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    NotFound:
      description: Not found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    Conflict:
      description: Conflict
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
